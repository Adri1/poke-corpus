{"version":3,"file":"static/js/865.899a2faf.chunk.js","mappings":"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","sources":["searchWorker.ts","searchWorkerManager.ts","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["import 'compression-streams-polyfill';\r\n\r\nexport type SearchParams = {\r\n  query: string,\r\n  regex: boolean,\r\n  caseInsensitive: boolean,\r\n  common: boolean,\r\n  script: boolean,\r\n  collections: string[],\r\n  languages: string[]\r\n};\r\n\r\nexport type SearchTask = {\r\n  index: number,\r\n  params: SearchParams,\r\n  collectionKey: string,\r\n  fileKey: string,\r\n  languages: string[]\r\n}\r\n\r\nexport type SearchTaskResult = {\r\n  index: number,\r\n  status: string,\r\n  resultLanguages?: string[],\r\n  result?: [string, string, string[][]]\r\n}\r\n\r\nexport const cacheVersion = \"v1\";\r\n\r\n/* eslint-disable no-restricted-globals */\r\nself.onmessage = (task: MessageEvent<SearchTask>) => {\r\n  //#region Helper functions\r\n  /**\r\n   * Attempts the following, in order:\r\n   * - Retrieving the file from the cache\r\n   * - Populating the cache with the file\r\n   * - Fetching the file directly\r\n   *\r\n   * Returns a promise of the text of the file.\r\n   */\r\n  const getFileFromCache = (collectionKey: string, languageKey: string, fileKey: string) => {\r\n    const url = process.env.PUBLIC_URL + `/corpus/${collectionKey}/${languageKey}_${fileKey}.txt.gz`;\r\n    return caches.open(cacheVersion)\r\n    .then((cache) => cache.match(url).then(res => res\r\n      ?? cache.add(url).then(() => cache.match(url)).then(res => res\r\n        ?? fetch(url))))\r\n    .catch(() => fetch(url))\r\n    .catch((err) => {\r\n      console.error(err);\r\n      notify('network');\r\n      return null;\r\n    })\r\n    .then((res) => res === null ? '' :\r\n      res.blob().then((blob) => new Response(blob.stream().pipeThrough(new DecompressionStream('gzip'))).text()))\r\n    .then(preprocessString);\r\n  }\r\n\r\n  // SMUSUM Chinese Pokémon names\r\n  const chineseChars = '蛋妙蛙种子草花小火龙恐喷杰尼龟卡咪水箭绿毛虫铁甲蛹巴大蝶独角壳针蜂波比鸟拉达烈雀嘴阿柏蛇怪皮丘雷穿山鼠王多兰娜后朗力诺可西六尾九胖丁超音蝠走路臭霸派斯特球摩鲁蛾地三喵猫老鸭哥猴暴蒂狗风速蚊香蝌蚪君泳士凯勇基胡腕豪喇叭芽口呆食玛瑙母毒刺拳石隆岩马焰兽磁合一葱嘟利海狮白泥舌贝鬼通耿催眠貘引梦人钳蟹巨霹雳电顽弹椰树嘎啦飞腿郎快头瓦双犀牛钻吉蔓藤袋墨金鱼星宝魔墙偶天螳螂迷唇姐击罗肯泰鲤普百变伊布边菊化盔镰刀翼急冻闪你哈克幻叶月桂竺葵锯鳄蓝立咕夜鹰芭瓢安圆丝蛛叉字灯笼古然咩羊茸美丽露才皇毽棉长手向日蜻蜓乌沼太阳亮黑暗鸦妖未知图腾果翁麒麟奇榛佛托土弟蝎钢千壶赫狃熊圈熔蜗猪珊瑚炮章桶信使翅戴加象顿Ⅱ惊鹿犬无畏战舞娃奶罐幸福公炎帝幼沙班洛亚凤时木守宫森林蜥蜴稚鸡壮跃狼纹直冲茧狩猎盾粉莲童帽乐河橡实鼻狡猾傲骨燕鸥莉奈朵溜糖雨蘑菇斗笠懒獭过动猿请假居忍面者脱妞吼爆幕下掌朝北优雅勾魂眼那恰姆落正拍负萤甜蔷薇溶吞牙鲨鲸驼煤炭跳噗晃斑颚蚁漠仙歌青绵七夕鼬斩饭匙鳅鲶虾兵螯秤念触摇篮羽丑纳飘浮泡隐怨影诅咒巡灵彷徨热带铃勃梭雪冰护豹珍珠樱空棘爱心哑属艾欧盖固坐祈代希苗台猛曼拿儿狸法师箱蟀勒伦琴含羞苞槌城结贵妇绅蜜女帕兹潜兔随卷耳魅东施铛响坦铜镜钟盆聒噪陆尖咬不良骷荧光霓虹自舔狂远Ｚ由卢席恩骑色霏莱谢米尔宙提主暖炒武刃丸剑探步哨约扒酷冷蚀豆鸽高雉幔庞滚蝙螺钉差搬运匠修建蟾蜍投摔打包保足蜈蚣车轮精根裙野蛮鲈混流氓红倒狒殿滑巾征哭具死神棺原肋始祖破灰尘索沫栗德单卵细胞造鹅倍四季萌哎呀败轻蜘坚齿组麻鳗宇烛幽晶斧嚏几何敏捷功夫父赤驹劈司令炸雄秃丫首恶燃烧毕云酋迪耶塔赛里狐呱贺掘彩蓓洁能鞘芳芙妮好鱿贼脚铠垃藻臂枪伞咚碎黏钥朽南瓜嗡哲裴格枭狙射炽咆哮虎漾壬笃啄铳少强锹农胜虻鬃弱坏驴仔重挽滴伪睡罩盗着竹疗环智挥猩掷胆噬堡爷参性：银伴陨枕戈谜拟Ｑ磨舵鳞杖璞・鸣哞鳍科莫迦虚吾肌费束辉纸御机夏蛋妙蛙種子草花小火龍恐噴傑尼龜卡咪水箭綠毛蟲鐵甲蛹巴大蝶獨角殼針蜂波比鳥拉達烈雀嘴阿柏蛇怪皮丘雷穿山鼠王多蘭娜后朗力諾可西六尾九胖丁超音蝠走路臭霸派斯特球摩魯蛾地三喵貓老鴨哥猴爆蒂狗風速蚊香蝌蚪君泳士凱勇基胡腕豪喇叭芽口呆食瑪瑙母毒刺拳石隆岩馬焰獸磁合一蔥嘟利海獅白泥舌貝鬼通耿催眠貘引夢人鉗蟹巨霹靂電頑彈椰樹嘎啦飛腿郎快頭瓦雙犀牛鑽吉蔓藤袋墨金魚星寶魔牆偶天螳螂迷唇姐擊羅肯泰鯉暴普百變伊布邊菊化盔鐮刀翼急凍閃你哈克幻葉月桂竺葵鋸鱷藍立咕夜鷹芭瓢安圓絲蛛叉字燈籠古然咩羊茸美麗露才皇毽棉長手向日蜻蜓烏沼太陽亮黑暗鴉妖未知圖騰果翁麒麟奇榛佛托土弟蠍鋼千壺赫狃熊圈熔蝸豬珊瑚炮章桶信使翅戴加象頓Ⅱ驚鹿犬無畏戰舞娃奶罐幸福公炎帝幼沙班洛亞鳳時木守宮森林蜥蜴稚雞壯躍狼紋直衝繭狩獵盾粉蓮童帽樂河橡實鼻狡猾傲骨燕鷗莉奈朵溜糖雨蘑菇斗笠懶獺過動猿請假居忍面者脫妞吼幕下掌朝北優雅勾魂眼那恰姆落正拍負螢甜薔薇溶吞牙鯊鯨駝煤炭跳噗晃斑顎蟻漠仙歌青綿七夕鼬斬飯匙鰍鯰蝦兵螯秤念觸搖籃羽醜納飄浮泡隱怨影詛咒巡靈彷徨熱帶鈴勃梭雪冰護豹珍珠櫻空棘愛心啞屬艾歐蓋固坐祈代希苗台猛曼拿兒狸法師箱蟀勒倫琴含羞苞槌城結貴婦紳蜜女帕茲潛兔隨捲耳魅東施鐺響坦銅鏡鐘盆聒噪陸尖咬不良骷光霓虹自舔狂遠Ｚ由盧席恩騎色霏萊謝米爾宙提主暖炒武刃丸劍探步哨約扒酷冷蝕豆鴿高雉幔龐滾蝙螺釘差搬運匠修建蟾蜍投摔打包保足蜈蚣車輪毬精根裙野蠻鱸混流氓紅倒狒殿滑巾徵哭具死神棺原肋始祖破灰塵索沫栗德單卵細胞造鵝倍四季萌哎呀敗輕蜘堅齒組麻鰻宇燭幽晶斧嚏幾何敏捷功夫父赤駒劈司令炸雄禿丫首惡燃燒畢雲酋迪耶塔賽里狐呱賀掘彩蓓潔能鞘芳芙妮好魷賊腳鎧垃藻臂槍傘咚碎黏鑰朽南瓜嗡哲裴格梟狙射熾咆哮虎漾壬篤啄銃少強鍬農勝虻鬃弱壞驢仔重挽滴偽睡罩盜著竹療環智揮猩擲膽噬堡爺參性：銀伴隕枕戈謎擬Ｑ磨舵鱗杖璞・鳴哞鰭科莫迦虛吾肌費束輝紙御機夏垒磊砰奥壘磊砰丑奧';\r\n  const remapChineseChars = (s: string) => {\r\n    return s.search(/[\\uE800-\\uEE26]/u) === -1 ? s : (\r\n      Array.from(s).map((c) => {\r\n        const codePoint = c.codePointAt(0);\r\n        return (codePoint !== undefined && codePoint >= 0xE800 && codePoint <= 0xEE26) ? chineseChars[codePoint - 0xE800] : c;\r\n      }).join('')\r\n    );\r\n  }\r\n\r\n  // ORAS Korean Braille\r\n  const remapKoreanBraille = (s: string) => {\r\n    return s.search(/[\\u1100-\\u11FF\\uE0C0-\\uE0C7]/u) === -1 ? s : (s\r\n      .replaceAll('\\uE0C0', '그래서') // geuraeseo\r\n      .replaceAll('\\uE0C1', '그러나') // geureona\r\n      .replaceAll('\\uE0C2', '그러면') // geureomyeon\r\n      .replaceAll('\\uE0C3', '그러므로') // geureomeuro\r\n      .replaceAll('\\uE0C4', '그런데') // geureonde\r\n      .replaceAll('\\uE0C5', '그') // UNUSED go\r\n      .replaceAll('\\uE0C6', '그리하여') // geurihayeo\r\n      .replaceAll('ᆨᅩ', '그리고') // geurigeo\r\n      .replaceAll('\\uE0C7ᄉ', 'ᄊ') // ss\r\n      .replaceAll('\\uE0C7ᄀ', 'ᄁ') // kk\r\n      .replaceAll('\\uE0C7ᄃ', 'ᄄ') // tt\r\n      .replaceAll('\\uE0C7ᄇ', 'ᄈ') // pp\r\n      .replaceAll('\\uE0C7ᄌ', 'ᄍ') // jj\r\n      .replaceAll('\\uE0C7', 'ᄉ') // unmatched double consonant\r\n      .replaceAll(/([\\u1100-\\u115F])([억옹울옥연운온언얼열인영을은])/gu, (_, initial: string, syllable: string) => initial + syllable.normalize(\"NFD\").substring(1)) // combine initial with abbreviations\r\n      .replaceAll(/([가나다마바사자카타파하])([\\u11A8-\\u11FF])/gu, (_, syllable: string, final: string) => syllable.normalize(\"NFD\") + final) // combine abbreviations with final\r\n      .replaceAll(/^[\\u1160-\\u1175]+$/gum, (match) => '\\u115F' + match.split('').join('\\u115F')) // filler for unmatched vowels in strings of unmatched vowels\r\n      .replaceAll(/(?<![\\u1100-\\u115F])([\\u1160-\\u1175])/gu, 'ᄋ$1') // add null initial to all other unmatched vowels\r\n      .replaceAll(/([\\u1100-\\u115F])(?![\\u1160-\\u1175]|$)/gum, '$1\\u1160') // filler for unmatched initials\r\n      .replaceAll(/(?<![\\u1160-\\u1175])([\\u11A8-\\u11FF])/gum, '\\u115F\\u1160$1') // filler for unmatched finals\r\n      .normalize()\r\n    );\r\n  }\r\n\r\n  // NDS special characters\r\n  const remapNDSSpecialCharacters = (s: string) => {\r\n    return s.search(/[\\u2460-\\u2487]/u) === -1 ? s : (s\r\n      .replaceAll('\\u2469', 'ᵉʳ') // Gen 5 superscript er\r\n      .replaceAll('\\u246A', 'ʳᵉ') // Gen 5 superscript re\r\n      .replaceAll('\\u246B', 'ʳ') // Gen 5 superscript r\r\n      .replaceAll('\\u2485', 'ᵉ') // Gen 5 superscript e\r\n    );\r\n  }\r\n\r\n  // 3DS special characters\r\n  const remap3DSSpecialCharacters = (s: string) => {\r\n    return remapChineseChars(remapKoreanBraille(\r\n      s.search(/[\\uE000-\\uE0A8]/u) === -1 ? s : (s\r\n        // System\r\n        .replaceAll('\\uE000', 'Ⓐ') // A Button\r\n        .replaceAll('\\uE001', 'Ⓑ') // B Button\r\n        .replaceAll('\\uE002', 'Ⓧ') // X Button\r\n        .replaceAll('\\uE003', 'Ⓨ') // Y Button\r\n        .replaceAll('\\uE004', 'Ⓛ') // L Button\r\n        .replaceAll('\\uE005', 'Ⓡ') // R Button\r\n        .replaceAll('\\uE006', '✜') // Control Pad\r\n        .replaceAll('\\uE073', '🏠︎') // Home Button\r\n\r\n        // Pokémon private use\r\n        .replaceAll('\\uE08A', 'ᵉʳ') // Superscript er\r\n        .replaceAll('\\uE08B', 'ʳᵉ') // Superscript re\r\n        .replaceAll('\\uE08C', 'ʳ') // Superscript r\r\n        .replaceAll('\\uE092', '♥') // Halfwidth eighth note\r\n        .replaceAll('\\uE09A', '♪') // Halfwidth eighth note\r\n        .replaceAll('\\uE0A6', 'ᵉ') // Superscript e\r\n\r\n        // ORAS Braille\r\n        .replaceAll('\\uE081', '.') // French period (dots-256) [UNUSED]\r\n        .replaceAll('\\uE082', ',') // French comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE083', '.') // Italian period (dots-256) [UNUSED]\r\n        .replaceAll('\\uE084', ',') // Italian comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE085', '.') // German period (dots-3)\r\n        .replaceAll('\\uE086', ',') // German comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE087', '.') // Spanish period (dots-3)\r\n        .replaceAll('\\uE088', ',') // Spanish comma (dots-2) [UNUSED]\r\n      )\r\n    ));\r\n  }\r\n\r\n  // Switch special characters\r\n  const remapSwitchSpecialCharacters = (s: string) => {\r\n    return s.search(/[\\uE300-\\uE31C]/u) === -1 ? s : (s\r\n      .replaceAll('\\uE300', '$') // Pokémon Dollar\r\n      .replaceAll('\\uE301', 'A') // Unown A\r\n      .replaceAll('\\uE302', 'B') // Unown B\r\n      .replaceAll('\\uE303', 'C') // Unown C\r\n      .replaceAll('\\uE304', 'D') // Unown D\r\n      .replaceAll('\\uE305', 'E') // Unown E\r\n      .replaceAll('\\uE306', 'F') // Unown F\r\n      .replaceAll('\\uE307', 'G') // Unown G\r\n      .replaceAll('\\uE308', 'H') // Unown H\r\n      .replaceAll('\\uE309', 'I') // Unown I\r\n      .replaceAll('\\uE30A', 'J') // Unown J\r\n      .replaceAll('\\uE30B', 'K') // Unown K\r\n      .replaceAll('\\uE30C', 'L') // Unown L\r\n      .replaceAll('\\uE30D', 'M') // Unown M\r\n      .replaceAll('\\uE30E', 'N') // Unown N\r\n      .replaceAll('\\uE30F', 'O') // Unown O\r\n      .replaceAll('\\uE310', 'P') // Unown P\r\n      .replaceAll('\\uE311', 'Q') // Unown Q\r\n      .replaceAll('\\uE312', 'R') // Unown R\r\n      .replaceAll('\\uE313', 'S') // Unown S\r\n      .replaceAll('\\uE314', 'T') // Unown T\r\n      .replaceAll('\\uE315', 'U') // Unown U\r\n      .replaceAll('\\uE316', 'V') // Unown V\r\n      .replaceAll('\\uE317', 'W') // Unown W\r\n      .replaceAll('\\uE318', 'X') // Unown X\r\n      .replaceAll('\\uE319', 'Y') // Unown Y\r\n      .replaceAll('\\uE31A', 'Z') // Unown Z\r\n      .replaceAll('\\uE31B', '!') // Unown !\r\n      .replaceAll('\\uE31C', '?') // Unown ?\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Appends additional metadata to each string:\r\n   * - For strings with ruby, appends copies of the strings with the ruby text converted to kana/kanji so that they can be searched.\r\n   *   These copies are separated by `U+F0000` and `U+F0001` so that they can be stripped before display.\r\n   *\r\n   * Returns the resulting string.\r\n   */\r\n  const preprocessMetadata = (s: string) => {\r\n    return s.search(/\\{[^|}]+\\|[^|}]+\\}/u) === -1 ? s : (\r\n      s.replaceAll(/^.*\\{[^|}]+\\|[^|}]+\\}.*$/gum, (line) => {\r\n        const lineKanji = line.replaceAll(/\\{([^|}]+)\\|[^|}]+\\}/gu, '$1');\r\n        const lineKana = line.replaceAll(/\\{[^|}]+\\|([^|}]+)\\}/gu, '$1');\r\n        return [line, '\\u{F0000}', lineKanji, '\\u{F0001}', lineKana].join('');\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Converts private use characters to the corresponding Unicode characters,\r\n   * and adds additional searchable metadata.\r\n   *\r\n   * Returns the resulting string.\r\n   */\r\n  const preprocessString = (s: string) => {\r\n    return preprocessMetadata(remapSwitchSpecialCharacters(remap3DSSpecialCharacters(remapNDSSpecialCharacters(s))));\r\n  }\r\n\r\n  /**\r\n   * Strips additional metadata from each string:\r\n   * - Converted ruby text marked with `U+F0000` and `U+F0001`\r\n   *\r\n   * Returns the resulting string.\r\n   */\r\n  const postprocessMetadata = (s: string) => {\r\n    return s.split('\\u{F0000}')[0];\r\n  }\r\n\r\n  /**\r\n   * Converts the provided string to HTML by escaping `<` and `>`,\r\n   * replacing line break control characters such as  `\\n` with `<br>`,\r\n   * and converting the ruby syntax `{base|ruby}` to the corresponding HTML tags.\r\n   *\r\n   * Returns the resulting HTML string.\r\n   */\r\n  const postprocessString = (s: string) => {\r\n    return (postprocessMetadata(s)\r\n      .replaceAll('<', '&lt;').replaceAll('>', '&gt;')\r\n      .replaceAll('\\u2486', '<sup>P</sup><sub>K</sub>') // Gen 5 PK\r\n      .replaceAll('\\u2487', '<sup>M</sup><sub>N</sub>') // Gen 5 MN\r\n      .replaceAll('\\uE0A7', '<sup>P</sup><sub>K</sub>') // 3DS PK\r\n      .replaceAll('\\uE0A8', '<sup>M</sup><sub>N</sub>') // 3DS MN\r\n      .replaceAll('\\\\r\\\\n', '<span class=\"r\">&#92;r</span><span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('\\\\c\\\\n', '<span class=\"c\">&#92;c</span><span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('\\\\r', '<span class=\"r\">&#92;r</span><br>')\r\n      .replaceAll('\\\\c', '<span class=\"c\">&#92;c</span><br>')\r\n      .replaceAll('\\\\n', '<span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('\\t', '<span class=\"tab\">\\t</span>')\r\n      .replaceAll('[NULL]', '<span class=\"null\">[NULL]</span>')\r\n      .replaceAll('[COMP]', '<span class=\"compressed\">[COMP]</span>')\r\n      .replaceAll(/(\\[VAR [0-9A-F]{4}(?:\\([0-9A-F]{4}(?:,[0-9A-F]{4})*\\))\\])/gu, '<span class=\"var\">$1</span>')\r\n      .replaceAll(/(\\[WAIT \\d+\\])/gu, '<span class=\"wait\">$1</span>')\r\n      .replaceAll(/(\\[~ \\d+\\])/gu, '<span class=\"unused\">$1</span>')\r\n      .replaceAll(/\\{([^|}]+)\\|([^|}]+)\\}/gu, '<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>') // Switch furigana\r\n      .replaceAll(/^(\\s+)$/gu, '<span class=\"whitespace\">$1</span>')\r\n    );\r\n  };\r\n  //#endregion\r\n\r\n  const {index, params, collectionKey, fileKey, languages} = task.data;\r\n  const notify = (status: string, resultLanguages?: string[], result?: [string, string, string[][]]) => {\r\n    const message: SearchTaskResult = {\r\n      index: index,\r\n      status: status,\r\n      resultLanguages: resultLanguages,\r\n      result: result\r\n    }\r\n    postMessage(message);\r\n  }\r\n\r\n  let re: RegExp | null = null;\r\n  try {\r\n    if (params.regex) {\r\n      re = new RegExp(params.query, params.caseInsensitive ? 'ui' : 'u');\r\n    }\r\n  }\r\n  catch (err) {\r\n    console.error(err);\r\n    notify('regex');\r\n    return;\r\n  }\r\n\r\n  const matchCondition = (line: string): boolean => {\r\n    return (params.regex && re !== null && line.match(re) !== null)\r\n      || (!params.regex && !params.caseInsensitive && line.includes(params.query))\r\n      || (!params.regex && params.caseInsensitive && (line.toLowerCase().includes(params.query.toLowerCase()) || line.toUpperCase().includes(params.query.toUpperCase())));\r\n  };\r\n\r\n  try {\r\n    // Load files\r\n    const filePromises = languages.map((languageKey) => getFileFromCache(collectionKey, languageKey, fileKey).then((data) => [languageKey, data] as [string, string]));\r\n    filePromises.forEach((promise) => promise.then(() => notify('loading'))); // for progress bar\r\n\r\n    // Process files\r\n    const processingFilePromises = filePromises.map((promise) => promise.then(([languageKey, data]) => {\r\n      const lines = data.split(/\\r\\n|\\n/);\r\n      const lineKeys: number[] = [];\r\n\r\n      // Check selected languages for lines that satisfy the query\r\n      if (params.languages.includes(languageKey)) {\r\n        lines.forEach((line, i) => {\r\n          if (matchCondition(line)) {\r\n            lineKeys.push(i);\r\n          }\r\n        });\r\n      }\r\n      return [languageKey, lineKeys, lines] as [string, number[], string[]];\r\n    }));\r\n    processingFilePromises.forEach((promise) => promise.then(() => notify('processing'))); // for progress bar\r\n\r\n    // Filter only the lines that matched\r\n    Promise.all(processingFilePromises).then((processedFiles) => {\r\n      const languageKeys: string[] = [];\r\n      const lineKeysSet: Set<number> = new Set();\r\n      const fileData: string[][] = [];\r\n\r\n      processedFiles.forEach(([languageKey, lineKeys, lines]) => {\r\n        languageKeys.push(languageKey);\r\n        lineKeys.forEach((i) => lineKeysSet.add(i));\r\n        fileData.push(lines);\r\n      });\r\n\r\n      const fileResults: string[][] = [];\r\n      Array.from(lineKeysSet).sort((a, b) => a - b).forEach((i) => fileResults.push(fileData.map((lines) => postprocessString(lines[i] ?? ''))));\r\n      notify('done', languageKeys, [collectionKey, fileKey, fileResults]);\r\n    })\r\n    .catch((err) => {\r\n      console.error(err);\r\n      notify('error');\r\n    });\r\n  }\r\n  catch (err) {\r\n    console.error(err);\r\n    notify('error');\r\n  }\r\n};\r\n","import corpus from './i18n/corpus.json'\r\nimport { SearchParams, SearchTask, SearchTaskResult, cacheVersion } from './searchWorker';\r\n\r\nexport type SearchResults = {\r\n  complete: boolean,\r\n  status: string,\r\n  progress: number,\r\n  resultsLanguages: string[][],\r\n  results: [string, string, string[][]][]\r\n};\r\n\r\n/* eslint-disable no-restricted-globals */\r\nself.onmessage = (message: MessageEvent<SearchParams>) => {\r\n  const progressPortionLoading = 0.49;\r\n  const progressPortionProcessing = 0.49;\r\n  const progressPortionCollecting = 0.01; // 0.01 for rendering\r\n\r\n  const updateStatusInProgress = (status: string, loadingProgress: number, processingProgress: number, collectingProgress: number) => {\r\n    const progress = loadingProgress * progressPortionLoading + processingProgress * progressPortionProcessing + collectingProgress * progressPortionCollecting;\r\n    const message: SearchResults = {\r\n      complete: false,\r\n      status: status,\r\n      progress: progress,\r\n      resultsLanguages: [],\r\n      results: []\r\n    };\r\n    postMessage(message);\r\n  };\r\n\r\n  const updateStatusComplete = (status: string, resultsLanguages: string[][] = [], results: [string, string, string[][]][] = []) => {\r\n    const message: SearchResults = {\r\n      complete: true,\r\n      status: status,\r\n      progress: 1.0,\r\n      resultsLanguages: resultsLanguages,\r\n      results: results\r\n    };\r\n    postMessage(message);\r\n  };\r\n\r\n  try {\r\n    const params = message.data;\r\n    updateStatusInProgress('loading', 0, 0, 0);\r\n\r\n    // Clear old caches\r\n    caches.keys().then((keyList) => Promise.all(keyList.filter((key) => key !== cacheVersion).map((key) => caches.delete(key))));\r\n\r\n    // Load files\r\n    let taskCount = 0;\r\n    const taskList: SearchTask[] = [];\r\n    Object.keys(corpus.collections).filter((collectionKey) => params.collections.includes(collectionKey)).forEach((collectionKey) => {\r\n      const collection = corpus.collections[collectionKey as keyof typeof corpus.collections];\r\n\r\n      // Do not process collection if it does not include any language being searched\r\n      if (params.languages.every((languageKey) => !collection.languages.includes(languageKey))) {\r\n        return;\r\n      }\r\n\r\n      // Load all files in all languages in the collection\r\n      collection.files\r\n      .filter((fileKey) => !((fileKey === 'common' && !params.common) || (fileKey === 'script' && !params.script)))\r\n      .forEach((fileKey) => {\r\n        taskList.push({\r\n          index: taskCount,\r\n          params: params,\r\n          collectionKey: collectionKey,\r\n          fileKey: fileKey,\r\n          languages: collection.languages\r\n        })\r\n        taskCount += collection.languages.length;\r\n      });\r\n    });\r\n\r\n    // Initialize helpers\r\n    let loadedCount = 0;\r\n    let processedCount = 0;\r\n    let collectedCount = 0;\r\n    const taskResults: SearchTaskResult[] = [];\r\n    const helpers: Worker[] = [];\r\n    const helperOnMessage = (e: MessageEvent<SearchTaskResult>) => {\r\n      const result = e.data;\r\n      if (result.status === 'loading') {\r\n        loadedCount++;\r\n        updateStatusInProgress('loading', loadedCount/taskCount, processedCount/taskCount, collectedCount/taskList.length);\r\n        if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n          console.log(`Loaded ${loadedCount}/${taskCount}`);\r\n        }\r\n      }\r\n      else if (result.status === 'processing') {\r\n        processedCount++;\r\n        updateStatusInProgress('processing', loadedCount/taskCount, processedCount/taskCount, collectedCount/taskList.length);\r\n        if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n          console.log(`Processed ${processedCount}/${taskCount}`);\r\n        }\r\n      }\r\n      else if (result.status === 'done') {\r\n        taskResults.push(result);\r\n        collectedCount++;\r\n        updateStatusInProgress('collecting', loadedCount/taskCount, processedCount/taskCount, collectedCount/taskList.length);\r\n        if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n          console.log(`Collected ${collectedCount}/${taskList.length}`);\r\n        }\r\n\r\n        // Send results\r\n        if (collectedCount === taskList.length) {\r\n          const resultsLanguages: string[][] = [];\r\n          const results: [string, string, string[][]][] = [];\r\n          taskResults.sort((a, b) => a.index - b.index);\r\n          taskResults.forEach((taskResult) => {\r\n            if (taskResult.resultLanguages !== undefined && taskResult.result !== undefined) {\r\n              resultsLanguages.push(taskResult.resultLanguages);\r\n              results.push(taskResult.result);\r\n            }\r\n          });\r\n          updateStatusComplete('done', resultsLanguages, results);\r\n          helpers.forEach((helper) => helper.terminate());\r\n        }\r\n      }\r\n      else { // error\r\n        updateStatusComplete(result.status);\r\n        helpers.forEach((helper) => helper.terminate());\r\n      }\r\n    }\r\n\r\n    // Start helpers\r\n    const numWorkers = Math.min(taskList.length, (navigator.hardwareConcurrency - 2) || 4);\r\n    for (let i = 0; i < numWorkers; i++) {\r\n      const helper = new Worker(new URL(\"./searchWorker.ts\", import.meta.url));\r\n      helper.onmessage = helperOnMessage;\r\n      helpers.push(helper);\r\n    }\r\n    taskList.forEach((task, i) => {\r\n      helpers[i % helpers.length].postMessage(task);\r\n    });\r\n  }\r\n  catch (err) {\r\n    console.error(err);\r\n    updateStatusComplete('error');\r\n  }\r\n};\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [935], function() { return __webpack_require__(865); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + {\"534\":\"4e6f01b0\",\"935\":\"5c991603\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/poke-corpus/\";","__webpack_require__.b = self.location + \"/../../../\";\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t865: 1,\n\t534: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkpoke_corpus\"] = self[\"webpackChunkpoke_corpus\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn __webpack_require__.e(935).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["cacheVersion","self","onmessage","task","remap3DSSpecialCharacters","s","search","Array","from","map","c","codePoint","codePointAt","undefined","join","remapChineseChars","replaceAll","_","initial","syllable","normalize","substring","final","match","split","remapKoreanBraille","preprocessString","line","lineKanji","lineKana","preprocessMetadata","remapSwitchSpecialCharacters","remapNDSSpecialCharacters","_task$data","data","index","params","collectionKey","fileKey","languages","notify","status","resultLanguages","result","postMessage","re","regex","RegExp","query","caseInsensitive","err","console","error","filePromises","languageKey","url","process","concat","caches","open","then","cache","res","add","fetch","catch","blob","Response","stream","pipeThrough","DecompressionStream","text","getFileFromCache","forEach","promise","processingFilePromises","_ref","_ref2","_slicedToArray","lines","lineKeys","includes","i","toLowerCase","toUpperCase","matchCondition","push","Promise","all","processedFiles","languageKeys","lineKeysSet","Set","fileData","_ref3","_ref4","fileResults","sort","a","b","_lines$i","postprocessMetadata","message","updateStatusInProgress","loadingProgress","processingProgress","collectingProgress","complete","progress","resultsLanguages","results","updateStatusComplete","arguments","length","keys","keyList","filter","key","delete","taskCount","taskList","Object","corpus","collections","collection","every","files","common","script","loadedCount","processedCount","collectedCount","taskResults","helpers","helperOnMessage","e","taskResult","helper","terminate","numWorkers","Math","min","navigator","hardwareConcurrency","Worker","URL","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","x","__webpack_exports__","O","deferred","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","splice","r","d","definition","o","defineProperty","enumerable","get","f","chunkId","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","call","p","location","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","next"],"sourceRoot":""}