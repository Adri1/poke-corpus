{"version":3,"file":"static/js/757.57e28f5c.chunk.js","mappings":"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","sources":["../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","searchWorker.ts"],"sourcesContent":["export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (null != _i) {\n    var _s,\n      _e,\n      _x,\n      _r,\n      _arr = [],\n      _n = !0,\n      _d = !1;\n    try {\n      if (_x = (_i = _i.call(arr)).next, 0 === i) {\n        if (Object(_i) !== _i) return;\n        _n = !1;\n      } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n    } catch (err) {\n      _d = !0, _e = err;\n    } finally {\n      try {\n        if (!_n && null != _i[\"return\"] && (_r = _i[\"return\"](), Object(_r) !== _r)) return;\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import corpus from './i18n/corpus.json'\r\n\r\nexport type SearchParams = {\r\n  query: string,\r\n  regex: boolean,\r\n  caseInsensitive: boolean,\r\n  common: boolean,\r\n  script: boolean,\r\n  collections: string[],\r\n  languages: string[]\r\n};\r\n\r\nexport type SearchResults = {\r\n  complete: boolean,\r\n  status: string,\r\n  filename: string,\r\n  resultsLanguages: string[][],\r\n  results: string[][][]\r\n};\r\n\r\nfunction postProcess(s: string) {\r\n  return s.replaceAll(/\\\\r\\\\n|\\\\c\\\\n|\\\\n/g, '\\n').replaceAll(/\\\\r|\\\\c|\\\\l|\\\\x25BD/g, '\\n').trimStart();\r\n}\r\n\r\n/* eslint-disable no-restricted-globals */\r\nself.onmessage = (message: MessageEvent<SearchParams>) => {\r\n  const params = message.data;\r\n  const re = params.regex ? new RegExp(params.query, params.caseInsensitive ? 'ui' : 'u') : null;\r\n\r\n  let corpusPromises: Promise<[string[], Set<number>, string[][]]>[] = [];\r\n\r\n  params.collections.forEach((collectionKey) => {\r\n    const collection = corpus.collections[collectionKey as keyof typeof corpus.collections];\r\n    collection.files.forEach((fileKey) => {\r\n      postMessage({\r\n        complete: false,\r\n        status: 'loading',\r\n        filename: `${collectionKey}_${fileKey}`,\r\n        resultsLanguages: [],\r\n        results: []\r\n      });\r\n\r\n      if (fileKey === 'common' && !params.common) {\r\n        return;\r\n      }\r\n      if (fileKey === 'script' && !params.script) {\r\n        return;\r\n      }\r\n\r\n      let collectionPromises: Promise<[[string, string[]], number[]]>[] = [];\r\n      collection.languages.forEach((languageKey) => {\r\n        postMessage({\r\n          complete: false,\r\n          status: 'loading',\r\n          filename: `${collectionKey}_${languageKey}_${fileKey}`,\r\n          resultsLanguages: [],\r\n          results: []\r\n        });\r\n\r\n        const url = `/poke-corpus/corpus/${collectionKey}/${languageKey}_${fileKey}.txt`;\r\n        collectionPromises.push(\r\n          caches.open(\"v1\")\r\n          .then((cache) => cache.match(url)\r\n            .then(res => res ?? fetch(url).then((res) => cache.put(url, res).then(() => cache.match(url).then((res) => res ?? fetch(url))))))\r\n          .catch(() => fetch(url))\r\n          .then((res) => res.text())\r\n          .then((data) => {\r\n            const lines = data.split(/\\r\\n|\\n/);\r\n            let lineKeys: number[] = [];\r\n\r\n            postMessage({\r\n              complete: false,\r\n              status: 'processing',\r\n              filename: `${collectionKey}_${languageKey}_${fileKey}`,\r\n              resultsLanguages: [],\r\n              results: []\r\n            });\r\n\r\n            if (params.languages.includes(languageKey)) {\r\n              lines.forEach((line, i) => {\r\n                if ((params.regex && re !== null && line.match(re))\r\n                    || (!params.regex && !params.caseInsensitive && line.includes(params.query))\r\n                    || (!params.regex && params.caseInsensitive && (line.toLowerCase().includes(params.query.toLowerCase()) || line.toUpperCase().includes(params.query.toUpperCase())))) {\r\n                  lineKeys.push(i);\r\n                }\r\n              });\r\n            }\r\n\r\n            postMessage({\r\n              complete: false,\r\n              status: `processingDone`,\r\n              filename: `${collectionKey}_${languageKey}_${fileKey}`,\r\n              resultsLanguages: [],\r\n              results: []\r\n            });\r\n\r\n            return [[languageKey, lines], lineKeys];\r\n          }));\r\n      });\r\n      corpusPromises.push(Promise.all(collectionPromises).then((corpusResult) => {\r\n        let languageKeys: string[] = [];\r\n        let lineKeys: Set<number> = new Set();\r\n        let fileData: string[][] = [];\r\n\r\n        corpusResult.forEach(([[languageKeyResult, linesResult], lineKeysResult]) => {\r\n          languageKeys.push(languageKeyResult);\r\n          lineKeysResult.forEach((lineKey) => lineKeys.add(lineKey));\r\n          fileData.push(linesResult);\r\n        })\r\n\r\n        return [languageKeys, lineKeys, fileData];\r\n      }));\r\n    });\r\n  });\r\n\r\n  let resultsLanguages: string[][] = [];\r\n  let results: string[][][] = [];\r\n  Promise.all(corpusPromises).then((corpusResults) => corpusResults.forEach(([languageKeys, lineKeys, fileData]) => {\r\n    let fileResults: string[][] = [];\r\n    Array.from(lineKeys).sort().forEach((i) => {\r\n      const lineResults = fileData.map((lines) => postProcess(lines[i] ?? ''));\r\n      fileResults.push(lineResults);\r\n    });\r\n    resultsLanguages.push(languageKeys);\r\n    results.push(fileResults);\r\n  })).then(() =>\r\n    postMessage({\r\n      complete: true,\r\n      status: \"done\",\r\n      filename: '',\r\n      resultsLanguages: resultsLanguages,\r\n      results: results\r\n    })\r\n  ).catch((err) => {\r\n    console.error(err);\r\n    postMessage({\r\n      complete: true,\r\n      status: \"error\",\r\n      filename: '',\r\n      resultsLanguages: [],\r\n      results: []\r\n    });\r\n  });\r\n};\r\n"],"names":["_arrayLikeToArray","arr","len","length","i","arr2","Array","_slicedToArray","isArray","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","call","next","Object","done","push","value","err","o","minLen","n","prototype","toString","slice","constructor","name","from","test","TypeError","self","onmessage","message","params","data","re","regex","RegExp","query","caseInsensitive","corpusPromises","collections","forEach","collectionKey","collection","corpus","files","fileKey","postMessage","complete","status","filename","concat","resultsLanguages","results","common","script","collectionPromises","languages","languageKey","url","caches","open","then","cache","match","res","fetch","put","catch","text","lines","split","lineKeys","includes","line","toLowerCase","toUpperCase","Promise","all","corpusResult","languageKeys","Set","fileData","_ref","_ref2","_ref2$","languageKeyResult","linesResult","lineKeysResult","lineKey","add","corpusResults","_ref3","_ref4","fileResults","sort","lineResults","map","_lines$i","replaceAll","trimStart","console","error"],"sourceRoot":""}